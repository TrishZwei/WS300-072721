<!DOCTYPE html>
<html>
<head>
	<title>barrel test</title>
<style type="text/css">
body{
    font-family: Verdana;
}

#gamearea{
 width: 1000px;
 height: 500px;
 overflow: hidden;
 position: relative;
 border: 1px solid black;
 margin: 0 auto;
}

#turret{
    border-radius: 50%;  
    height:100px;
    width: 100px;
    position: absolute;
    bottom: -50px;
    left: 450px;
    background-color: #666;
} 

#barrel{
    height: 150px;
    width: 40px;
    position: absolute;
    bottom:0;
    left: 480px;
    background-color: #999;
    border-radius: 20px 20px 0 0;
    -ms-tranform-origin: 50% 100%;
    -webkit-transform-origin: 50% 100%;
    transform-origin: 50% 100%;
}

</style>
</head>
<body>
<div id="gamearea">
<div id="calc">relX:<span id="relX">0</span> relY:<span id="relY">0</span> opposite:<span id="opp">0</span> adj:<span id="adj">0</span> angle:<span id="angle">0</span></div>
<div id="barrel"></div>
<div id="turret"></div>    
</div>    

<script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="jquery.transit.js"></script>
<script type="text/javascript"> 

//45, x:50, y:10    
//-45, x:-50, y:-10 
//-60, x:-60, y:-40
//-80, x -60, y:-80
    
$('#gamearea').mousemove(function(e){
 var gameW = $('#gamearea').width();
    var relX = e.pageX - $(this).offset().left;
    var relY = e.pageY - $(this).offset().top;
    var relBoxCoords = "(" + relX + "," + relY + ")";
    console.log(relBoxCoords);
    var adj;
    var opp;
    var angle;


if(relX<500.001){
     adj = 500 - relX;
     opp = 500 - relY;
     angle = Math.atan(adj/opp)/2;
    $('#barrel').css({ rotate: (angle*-100)});    
    }else{
     adj = relX - 500;
     opp = 500 - relY;
     angle = Math.atan(adj/opp)/2;
    $('#barrel').css({ rotate: (angle*100)});    
    }

//just visualizing the output
    $('#relX').html(relX);
    $('#relY').html(relY);
    $('#opp').html(opp);
    $('#adj').html(adj);
    $('#angle').html(angle);
});
</script>
</body>
</html>












